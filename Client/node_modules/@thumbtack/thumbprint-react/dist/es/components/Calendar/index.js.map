{"version":3,"file":"index.js","sources":["../../../../components/Calendar/index.tsx"],"sourcesContent":["import React from 'react';\nimport DayPicker, { DateUtils, Modifiers } from 'react-day-picker';\n\nimport get from 'lodash/get';\nimport map from 'lodash/map';\nimport findIndex from 'lodash/findIndex';\nimport some from 'lodash/some';\nimport castArray from 'lodash/castArray';\n\nimport parse from 'date-fns/parse';\nimport isAfter from 'date-fns/is_after';\nimport isBefore from 'date-fns/is_before';\nimport endOfDay from 'date-fns/end_of_day';\nimport startOfDay from 'date-fns/start_of_day';\n\nimport styles from './index.module.scss';\nimport { DateIsh, Modifier } from './types';\n\nfunction throwError(message: string): void {\n    throw new Error(`TUI DatePicker: ${message}`);\n}\n\nexport function normaliseValue(value: PropTypes['value']): Date[] {\n    const valueArr: DateIsh[] = castArray<DateIsh>(value);\n    return map<DateIsh, Date>(valueArr, d => parse(d));\n}\n\n// Returns true any of the given `dates` fall on a day before the day of `cutoff`.\nexport function hasAnyPastDays(dates: Date[], cutoff: Date = new Date()): boolean {\n    return some(dates, date => isBefore(endOfDay(date), cutoff));\n}\n\n// Returns true any of the given `dates` fall on a day after the day of `cutoff`.\nexport function hasAnyFutureDays(dates: Date[], cutoff: Date = new Date()): boolean {\n    return some(dates, date => isAfter(startOfDay(date), cutoff));\n}\n\nexport function validateProps(props: PropTypes): void {\n    const days = normaliseValue(props.value);\n\n    if (!props.allowMultiSelection && days.length > 1) {\n        throwError('`allowMultiSelection` is `false` but multiple dates were provided');\n    }\n\n    const { before, after } = props.disabledDays || {};\n    if (before && hasAnyPastDays(days, before)) {\n        throwError(\n            `Days before ${before} are disabled but one or more provided days fall before that.`,\n        );\n    }\n\n    if (after && hasAnyFutureDays(days, after)) {\n        throwError(\n            `Days after ${after} are disabled but one or more provided days fall after that.`,\n        );\n    }\n}\n\ninterface PropTypes {\n    /**\n     * One or more dates to show as selected in the initial UI. Each \"date\" can be a JS Date object\n     * or a string representing a date, or a numeric UNIX timestamp, and either a single object or\n     * an array of such objects can be provided.\n     */\n    value?: DateIsh | DateIsh[];\n    /**\n     * Date object representing the month that is currently displayed by the calendar. If omitted\n     * it will default to the first date in the `value` prop. You should update it in response to\n     * the `onMonthChange` prop.\n     */\n    month?: Date;\n    /**\n     * Callback that is triggered when th user selects a date. The function receives an array of\n     * a JavaScript Date objects for each of the currently selected dates.\n     */\n    onChange: (selectedDates: Date[]) => void;\n    /**\n     * Callback that is triggered when the user navigates to a different month using the navigation\n     * buttons or keyboard. The function receives a single JavaScript `Date` object indicating\n     * the new on-screen month.\n     */\n    onMonthChange: (selectedMonth: Date) => void;\n    /**\n     * Boolean that determines whether or not the user is allowed to select more than one date at\n     * a time. Defaults to `false`.\n     */\n    allowMultiSelection?: boolean;\n    /**\n     * A react-day-picker modifier for greater control over disabled days. Past selection is\n     * disabled by default.\n     * http://react-day-picker.js.org/docs/modifiers.html\n     */\n    disabledDays?: Modifier;\n    /**\n     * A Date object representing the last allowed month. Users wonâ€™t be able to navigate or\n     * interact with the days after it.\n     */\n    lastMonth?: Date;\n    /**\n     * Applies a blue dot indicator below the numeric day in the calendar's day cell if the\n     * function returns `true` for a given JavaScript `Date`.\n     */\n    daysThemeDotIndicator?: (date: Date) => boolean;\n    /**\n     * Applies a strikeout treatment on the numeric day in the calendar's day cell if the function\n     * returns `true` for a given JavaScript `Date`.\n     */\n    daysThemeStrikeout?: (date: Date) => boolean;\n}\n\n/**\n * Thin wrapper around `react-day-picker` that renders a calendar.\n */\nconst Calendar = ({\n    value = [],\n    onChange,\n    onMonthChange,\n    disabledDays = { before: new Date() },\n    month,\n    lastMonth,\n    allowMultiSelection = false,\n    daysThemeDotIndicator,\n    daysThemeStrikeout,\n}: PropTypes): JSX.Element => {\n    validateProps({\n        value,\n        onChange,\n        disabledDays,\n        month,\n        lastMonth,\n        allowMultiSelection,\n        onMonthChange,\n        daysThemeDotIndicator,\n        daysThemeStrikeout,\n    });\n\n    const selectedDays = normaliseValue(value);\n\n    const modifiers: Partial<Modifiers> = {};\n\n    if (typeof daysThemeDotIndicator === 'function') {\n        modifiers['theme-dot'] = daysThemeDotIndicator;\n    }\n\n    if (typeof daysThemeStrikeout === 'function') {\n        modifiers['theme-strikeout'] = daysThemeStrikeout;\n    }\n\n    return (\n        <div className={styles.root}>\n            <DayPicker\n                disabledDays={disabledDays}\n                fromMonth={get(disabledDays, 'before', null)}\n                toMonth={lastMonth}\n                month={month || selectedDays[0]}\n                initialMonth={month || selectedDays[0]}\n                selectedDays={selectedDays}\n                onMonthChange={onMonthChange}\n                modifiers={modifiers}\n                onDayClick={(day, { selected, disabled }): void => {\n                    if (disabled) {\n                        return;\n                    }\n\n                    let newSelectedDays = normaliseValue(value);\n\n                    if (allowMultiSelection) {\n                        if (selected) {\n                            const selectedIndex = findIndex(newSelectedDays, selectedDay =>\n                                DateUtils.isSameDay(selectedDay, day),\n                            );\n                            newSelectedDays.splice(selectedIndex, 1);\n                        } else {\n                            newSelectedDays.push(day);\n                        }\n                    } else {\n                        newSelectedDays = [day];\n                    }\n\n                    onChange(map(newSelectedDays, startOfDay));\n                }}\n            />\n        </div>\n    );\n};\n\nexport default Calendar;\n"],"names":["throwError","message","Error","normaliseValue","value","valueArr","castArray","map","d","parse","hasAnyPastDays","dates","cutoff","Date","some","date","isBefore","endOfDay","hasAnyFutureDays","isAfter","startOfDay","validateProps","props","days","allowMultiSelection","length","disabledDays","before","after","Calendar","onChange","onMonthChange","month","lastMonth","daysThemeDotIndicator","daysThemeStrikeout","selectedDays","modifiers","styles","root","get","day","selected","disabled","newSelectedDays","selectedIndex","findIndex","selectedDay","DateUtils","isSameDay","splice","push"],"mappings":"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"}